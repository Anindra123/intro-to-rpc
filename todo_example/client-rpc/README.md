# Todo Example Client RPC in PHP

This is a simple rpc client for sending rpc request to server. This client has example for both unary rpc call and server streaming rpc call.

## Dependencies

- gRPC/gRPC ver:^3.25
- google/protobuf ver:^1.57
- composer
- protoc

## Requirements

- Make sure ``protoc`` is installed on your local machine

- For mac os using brew it can be installed by 
```shell
brew install protoc
```

- Make sure you have php grpc extension install and enabled on the ``php.ini`` file

- If pecl is added it can be installed by the following command :

```bash
pecl install grpc
```

- For generating php code from the schema ``.proto`` file ``grpc_php_plugin`` is needed 
- The steps to install the plugin are given [here](https://grpc.io/docs/languages/php/basics/)

- After it has been installed the files can be generated by compiling the ``.proto`` file using the following command

```bash
$ protoc  \
  --php_out=<your output path> \
  --grpc_out=<your output path>\
  --plugin=protoc-gen-grpc=<your_php_grpc_plugin_path> \
  <your protofile path>
```

- If the ``grpc_php_plugin`` path is at ``/opt/homebrew/bin/grpc_php_plugin`` which can be seen by the following command
```bash
   $ which grpc_php_plugin
```

- Then the shell file provided ``php_gen.sh`` can be run which takes output folder path for the generated file and the protofile path and runs the above commands

```bash
   $ ./php_gen.sh <your_output_path> <your_proto_path>
```

- Make sure the folder path provided the folder is created before


- If the ``grpc_php_plugin`` is installed at a different path it can be set on the ``php_gen.sh`` file and can be run as well.

## Run Locally

- Clone the repository

```bash
    git clone https://github.com/Anindra123/intro-to-rpc.git
```

- Run the server after installing the dependencies

```bash
    cd intro-to-rpc/todo-example/server-rpc

    npm install

    node server.js
```

- Install client dependencies

```bash
   cd intro-to-rpc/todo-example/client-rpc

   composer install
```

- For running the unary example
- This will create a new todo on the server

```bash
    php src/CreateTodo.php todo_name
```

- For running the server streaming example
- This will print out all the todos stored at the server
```bash
    php src/ReadTodo.php 
```




